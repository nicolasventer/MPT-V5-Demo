import{f as MQ,h as QQ}from"./index.chunk-kny1f6t9.js";import{l as qQ,n as XQ,p as KQ,s as JQ,x as NQ,y as UQ,z as F}from"./index.chunk-wtzxm9sj.js";import{$ as m,Ca as s,Ea as a,F as LQ,Na as n,O as c,P as f,Pa as b,Q as _,Qa as t,R as u,S as l,Ta as e,Wa as YQ,Xa as H,Ya as ZQ,_a as y,ab as C,ca as P,gb as w,hb as $Q,ya as z,za as i}from"./index.chunk-gzmn61ft.js";function k(q,Y,Q){let Z=Q.initialDeps??[],$;return()=>{var K,X,N,U;let G;if(Q.key&&((K=Q.debug)==null?void 0:K.call(Q)))G=Date.now();let B=q();if(!(B.length!==Z.length||B.some((L,W)=>Z[W]!==L)))return $;Z=B;let D;if(Q.key&&((X=Q.debug)==null?void 0:X.call(Q)))D=Date.now();if($=Y(...B),Q.key&&((N=Q.debug)==null?void 0:N.call(Q))){let L=Math.round((Date.now()-G)*100)/100,W=Math.round((Date.now()-D)*100)/100,I=W/16,R=(M,PQ)=>{M=String(M);while(M.length<PQ)M=" "+M;return M};console.info(`%câ± ${R(W,5)} /${R(L,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*I,120))}deg 100% 31%);`,Q==null?void 0:Q.key)}return(U=Q==null?void 0:Q.onChange)==null||U.call(Q,$),$}}function j(q,Y){if(q===void 0)throw new Error(`Unexpected undefined${Y?`: ${Y}`:""}`);else return q}var E=(q,Y)=>Math.abs(q-Y)<1,h=(q,Y,Q)=>{let Z;return function(...$){q.clearTimeout(Z),Z=q.setTimeout(()=>Y.apply(this,$),Q)}};var GQ=(q)=>q,BQ=(q)=>{let Y=Math.max(q.startIndex-q.overscan,0),Q=Math.min(q.endIndex+q.overscan,q.count-1),Z=[];for(let $=Y;$<=Q;$++)Z.push($);return Z},x=(q,Y)=>{let Q=q.scrollElement;if(!Q)return;let Z=q.targetWindow;if(!Z)return;let $=(X)=>{let{width:N,height:U}=X;Y({width:Math.round(N),height:Math.round(U)})};if($(Q.getBoundingClientRect()),!Z.ResizeObserver)return()=>{};let K=new Z.ResizeObserver((X)=>{let N=X[0];if(N==null?void 0:N.borderBoxSize){let U=N.borderBoxSize[0];if(U){$({width:U.inlineSize,height:U.blockSize});return}}$(Q.getBoundingClientRect())});return K.observe(Q,{box:"border-box"}),()=>{K.unobserve(Q)}},v={passive:!0};var HQ=typeof window=="undefined"?!0:("onscrollend"in window),S=(q,Y)=>{let Q=q.scrollElement;if(!Q)return;let Z=q.targetWindow;if(!Z)return;let $=0,K=HQ?()=>{return}:h(Z,()=>{Y($,!1)},q.options.isScrollingResetDelay),X=(G)=>()=>{let{horizontal:B,isRtl:A}=q.options;$=B?Q.scrollLeft*(A&&-1||1):Q.scrollTop,K(),Y($,G)},N=X(!0),U=X(!1);return U(),Q.addEventListener("scroll",N,v),Q.addEventListener("scrollend",U,v),()=>{Q.removeEventListener("scroll",N),Q.removeEventListener("scrollend",U)}};var AQ=(q,Y,Q)=>{if(Y==null?void 0:Y.borderBoxSize){let Z=Y.borderBoxSize[0];if(Z)return Math.round(Z[Q.options.horizontal?"inlineSize":"blockSize"])}return Math.round(q.getBoundingClientRect()[Q.options.horizontal?"width":"height"])};var p=(q,{adjustments:Y=0,behavior:Q},Z)=>{var $,K;let X=q+Y;(K=($=Z.scrollElement)==null?void 0:$.scrollTo)==null||K.call($,{[Z.options.horizontal?"left":"top"]:X,behavior:Q})};class V{constructor(q){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let Y=null,Q=()=>{if(Y)return Y;if(!this.targetWindow||!this.targetWindow.ResizeObserver)return null;return Y=new this.targetWindow.ResizeObserver((Z)=>{Z.forEach(($)=>{this._measureElement($.target,$)})})};return{disconnect:()=>{var Z;(Z=Q())==null||Z.disconnect(),Y=null},observe:(Z)=>{var $;return($=Q())==null?void 0:$.observe(Z,{box:"border-box"})},unobserve:(Z)=>{var $;return($=Q())==null?void 0:$.unobserve(Z)}}})(),this.range=null,this.setOptions=(Y)=>{Object.entries(Y).forEach(([Q,Z])=>{if(typeof Z==="undefined")delete Y[Q]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:GQ,rangeExtractor:BQ,onChange:()=>{},measureElement:AQ,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,...Y}},this.notify=(Y)=>{var Q,Z;(Z=(Q=this.options).onChange)==null||Z.call(Q,this,Y)},this.maybeNotify=k(()=>{return this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]},(Y)=>{this.notify(Y)},{key:"maybeNotify",debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach((Y)=>Y()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>{return()=>{this.cleanup()}},this._willUpdate=()=>{var Y;let Q=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==Q){if(this.cleanup(),!Q){this.maybeNotify();return}if(this.scrollElement=Q,this.scrollElement&&"ownerDocument"in this.scrollElement)this.targetWindow=this.scrollElement.ownerDocument.defaultView;else this.targetWindow=((Y=this.scrollElement)==null?void 0:Y.window)??null;this.elementsCache.forEach((Z)=>{this.observer.observe(Z)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,(Z)=>{this.scrollRect=Z,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(Z,$)=>{this.scrollAdjustments=0,this.scrollDirection=$?this.getScrollOffset()<Z?"forward":"backward":null,this.scrollOffset=Z,this.isScrolling=$,this.maybeNotify()}))}},this.getSize=()=>{if(!this.options.enabled)return this.scrollRect=null,0;return this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]},this.getScrollOffset=()=>{if(!this.options.enabled)return this.scrollOffset=null,0;return this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset==="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset},this.getFurthestMeasurement=(Y,Q)=>{let Z=new Map,$=new Map;for(let K=Q-1;K>=0;K--){let X=Y[K];if(Z.has(X.lane))continue;let N=$.get(X.lane);if(N==null||X.end>N.end)$.set(X.lane,X);else if(X.end<N.end)Z.set(X.lane,!0);if(Z.size===this.options.lanes)break}return $.size===this.options.lanes?Array.from($.values()).sort((K,X)=>{if(K.end===X.end)return K.index-X.index;return K.end-X.end})[0]:void 0},this.getMeasurementOptions=k(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(Y,Q,Z,$,K)=>{return this.pendingMeasuredCacheIndexes=[],{count:Y,paddingStart:Q,scrollMargin:Z,getItemKey:$,enabled:K}},{key:!1}),this.getMeasurements=k(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:Y,paddingStart:Q,scrollMargin:Z,getItemKey:$,enabled:K},X)=>{if(!K)return this.measurementsCache=[],this.itemSizeCache.clear(),[];if(this.measurementsCache.length===0)this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach((G)=>{this.itemSizeCache.set(G.key,G.size)});let N=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];let U=this.measurementsCache.slice(0,N);for(let G=N;G<Y;G++){let B=$(G),A=this.options.lanes===1?U[G-1]:this.getFurthestMeasurement(U,G),D=A?A.end+this.options.gap:Q+Z,L=X.get(B),W=typeof L==="number"?L:this.options.estimateSize(G),I=D+W,R=A?A.lane:G%this.options.lanes;U[G]={index:G,start:D,size:W,end:I,key:B,lane:R}}return this.measurementsCache=U,U},{key:"getMeasurements",debug:()=>this.options.debug}),this.calculateRange=k(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(Y,Q,Z)=>{return this.range=Y.length>0&&Q>0?WQ({measurements:Y,outerSize:Q,scrollOffset:Z}):null},{key:"calculateRange",debug:()=>this.options.debug}),this.getIndexes=k(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(Y,Q,Z,$)=>{return Q===null?[]:Y({startIndex:Q.startIndex,endIndex:Q.endIndex,overscan:Z,count:$})},{key:"getIndexes",debug:()=>this.options.debug}),this.indexFromElement=(Y)=>{let Q=this.options.indexAttribute,Z=Y.getAttribute(Q);if(!Z)return console.warn(`Missing attribute name '${Q}={index}' on measured element.`),-1;return parseInt(Z,10)},this._measureElement=(Y,Q)=>{let Z=this.indexFromElement(Y),$=this.measurementsCache[Z];if(!$)return;let K=$.key,X=this.elementsCache.get(K);if(X!==Y){if(X)this.observer.unobserve(X);this.observer.observe(Y),this.elementsCache.set(K,Y)}if(Y.isConnected)this.resizeItem(Z,this.options.measureElement(Y,Q,this))},this.resizeItem=(Y,Q)=>{let Z=this.measurementsCache[Y];if(!Z)return;let $=this.itemSizeCache.get(Z.key)??Z.size,K=Q-$;if(K!==0){if(this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(Z,K,this):Z.start<this.getScrollOffset()+this.scrollAdjustments){if(this.options.debug)console.info("correction",K);this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=K,behavior:void 0})}this.pendingMeasuredCacheIndexes.push(Z.index),this.itemSizeCache=new Map(this.itemSizeCache.set(Z.key,Q)),this.notify(!1)}},this.measureElement=(Y)=>{if(!Y){this.elementsCache.forEach((Q,Z)=>{if(!Q.isConnected)this.observer.unobserve(Q),this.elementsCache.delete(Z)});return}this._measureElement(Y,void 0)},this.getVirtualItems=k(()=>[this.getIndexes(),this.getMeasurements()],(Y,Q)=>{let Z=[];for(let $=0,K=Y.length;$<K;$++){let X=Y[$],N=Q[X];Z.push(N)}return Z},{key:"getVirtualItems",debug:()=>this.options.debug}),this.getVirtualItemForOffset=(Y)=>{let Q=this.getMeasurements();if(Q.length===0)return;return j(Q[g(0,Q.length-1,(Z)=>j(Q[Z]).start,Y)])},this.getOffsetForAlignment=(Y,Q)=>{let Z=this.getSize(),$=this.getScrollOffset();if(Q==="auto")if(Y<=$)Q="start";else if(Y>=$+Z)Q="end";else Q="start";if(Q==="start")Y=Y;else if(Q==="end")Y=Y-Z;else if(Q==="center")Y=Y-Z/2;let K=this.options.horizontal?"scrollWidth":"scrollHeight",N=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[K]:this.scrollElement[K]:0)-Z;return Math.max(Math.min(N,Y),0)},this.getOffsetForIndex=(Y,Q="auto")=>{Y=Math.max(0,Math.min(Y,this.options.count-1));let Z=this.measurementsCache[Y];if(!Z)return;let $=this.getSize(),K=this.getScrollOffset();if(Q==="auto")if(Z.end>=K+$-this.options.scrollPaddingEnd)Q="end";else if(Z.start<=K+this.options.scrollPaddingStart)Q="start";else return[K,Q];let X=Q==="end"?Z.end+this.options.scrollPaddingEnd:Z.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(X,Q),Q]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{if(this.scrollToIndexTimeoutId!==null&&this.targetWindow)this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null},this.scrollToOffset=(Y,{align:Q="start",behavior:Z}={})=>{if(this.cancelScrollToIndex(),Z==="smooth"&&this.isDynamicMode())console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");this._scrollToOffset(this.getOffsetForAlignment(Y,Q),{adjustments:void 0,behavior:Z})},this.scrollToIndex=(Y,{align:Q="auto",behavior:Z}={})=>{if(Y=Math.max(0,Math.min(Y,this.options.count-1)),this.cancelScrollToIndex(),Z==="smooth"&&this.isDynamicMode())console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");let $=this.getOffsetForIndex(Y,Q);if(!$)return;let[K,X]=$;if(this._scrollToOffset(K,{adjustments:void 0,behavior:Z}),Z!=="smooth"&&this.isDynamicMode()&&this.targetWindow)this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(Y))){let[U]=j(this.getOffsetForIndex(Y,X));if(!E(U,this.getScrollOffset()))this.scrollToIndex(Y,{align:X,behavior:Z})}else this.scrollToIndex(Y,{align:X,behavior:Z})})},this.scrollBy=(Y,{behavior:Q}={})=>{if(this.cancelScrollToIndex(),Q==="smooth"&&this.isDynamicMode())console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");this._scrollToOffset(this.getScrollOffset()+Y,{adjustments:void 0,behavior:Q})},this.getTotalSize=()=>{var Y;let Q=this.getMeasurements(),Z;if(Q.length===0)Z=this.options.paddingStart;else Z=this.options.lanes===1?((Y=Q[Q.length-1])==null?void 0:Y.end)??0:Math.max(...Q.slice(-this.options.lanes).map(($)=>$.end));return Z-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(Y,{adjustments:Q,behavior:Z})=>{this.options.scrollToFn(Y,{behavior:Z,adjustments:Q},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(q)}}var g=(q,Y,Q,Z)=>{while(q<=Y){let $=(q+Y)/2|0,K=Q($);if(K<Z)q=$+1;else if(K>Z)Y=$-1;else return $}if(q>0)return q-1;else return 0};function WQ({measurements:q,outerSize:Y,scrollOffset:Q}){let Z=q.length-1,K=g(0,Z,(N)=>q[N].start,Q),X=K;while(X<Z&&q[X].end<Q+Y)X++;return{startIndex:K,endIndex:X}}var kQ=typeof document!=="undefined"?u:_;function FQ(q){let Y=f(()=>({}),{})[1],Q={...q,onChange:($,K)=>{var X;if(K)m(Y);else Y();(X=q.onChange)==null||X.call(q,$,K)}},[Z]=c(()=>new V(Q));return Z.setOptions(Q),_(()=>{return Z._didMount()},[]),kQ(()=>{return Z._willUpdate()}),Z}function d(q){return FQ({observeElementRect:x,observeElementOffset:S,scrollToFn:p,...q})}var gQ=(q)=>{let{extraItemCount:Y,...Q}=q,Z=d(Q),$=l([]);for(let U of Z.getVirtualItems())$.current[U.index]=U;let X=(Z.range?.endIndex??0)+Y+1;while($.current[X])delete $.current[X],X++;let N=Math.max((Z.range?.startIndex??0)-Y,0);X=N-1;while($.current[X])delete $.current[X],X--;return{rowVirtualizer:Z,expandedVirtualizeItems:$,startExpandedIndex:N}};var T=LQ(MQ(),1);var CQ={card:P(b,{label:"Card view",position:"top",children:P(qQ,{size:16},void 0,!1,void 0,this)},void 0,!1,void 0,this),table:P(b,{label:"Table view",position:"top",children:P(XQ,{size:16},void 0,!1,void 0,this)},void 0,!1,void 0,this)},O=H(!1),TQ=()=>P("div",{style:{position:"relative"},children:[P(t,{data:NQ.map((q)=>({value:q,label:CQ[q]})),size:C.value,style:{border:`solid 1px ${y.colorScheme.value==="dark"?"#424242":"#d0d4d9"}`},value:y.view.value,onChange:(q)=>{O.value=!0,setTimeout(()=>{y.view.value=q,O.value=!1,YQ.success(`Switched to ${q} view`,{duration:2000})},100)}},void 0,!1,void 0,this),P(n,{visible:O.value},void 0,!1,void 0,this)]},void 0,!0,void 0,this),o=UQ.map((q)=>`@${q}`),J={filterSearchValue:H(""),filterValue:H([]),category:H(""),options:H([]),filterDateRange:H([null,null]),hoveredFilterDateRange:H([null,null])},DQ=(q,Y)=>{if(!J.filterDateRange.value[0])J.hoveredFilterDateRange.value=[null,null];else if(J.filterDateRange.value[1])J.hoveredFilterDateRange.value=[J.filterDateRange.value[0],J.filterDateRange.value[1]];else if(J.filterDateRange.value[0]>Y)J.hoveredFilterDateRange.value=[Y,J.filterDateRange.value[0]];else J.hoveredFilterDateRange.value=[J.filterDateRange.value[0],Y]},r=ZQ(()=>`${J.filterDateRange.value[0]?T.default(J.filterDateRange.value[0]).format("DD/MM/YYYY"):"___"} - ${J.filterDateRange.value[1]?T.default(J.filterDateRange.value[1]).format("DD/MM/YYYY"):"___"}`),RQ=(async()=>Array.from(new Set(JQ.flatMap((q)=>[q.departure,...q.steps_,q.arrival]).map((q)=>q.libelle))))(),jQ=()=>P(z,{withArrow:!0,position:"bottom-start",opened:J.category.value===F.date,children:[P(z.Target,{children:P(e,{placeholder:'Filter (@ for category, " for space escape)',style:{flexGrow:1},size:C.value,splitChars:J.filterSearchValue.value.startsWith('"')?['"']:[" "],data:J.filterSearchValue.value.startsWith("@")?o:J.options.value,searchValue:J.category.value===F.date?r.value:J.filterSearchValue.value,onSearchChange:(q)=>J.category.value!==F.date&&(J.filterSearchValue.value=q),value:J.filterValue.value,onChange:(q)=>{if(J.category.value===F.date)return;if(J.options.value=[],o.includes(q.at(-1)??""))switch(J.category.value=q.at(-1)?.slice(1)??"",J.category.value){case F.route:RQ.then((Y)=>J.options.value=Y);break;case F.date:break}else if(!q.at(-1)?.startsWith("@"))J.filterValue.value=q.map((Y,Q)=>J.category.value&&Q===q.length-1?`${J.category.value} | ${Y}`:Y),J.category.value=""},leftSection:J.category.value&&P(w,{justifyContent:"space-between",width:"100%",margin:"0 10px",children:[P(s,{size:C.value,style:{flexGrow:1},children:J.category.value},void 0,!1,void 0,this),P(i,{variant:"default",size:C.value,children:P(KQ,{onClick:()=>J.category.value=""},void 0,!1,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this),leftSectionWidth:J.category.value?125:0,clearable:!0},void 0,!1,void 0,this)},void 0,!1,void 0,this),P(z.Dropdown,{children:[P(QQ,{type:"range",onChange:(q)=>J.filterDateRange.value=q,__onDayMouseEnter:DQ,getDayProps:(q)=>{if(!T.default().isSame(q,"date"))return{};if(J.hoveredFilterDateRange.value[0]&&J.hoveredFilterDateRange.value[1]&&T.default(q).add(1,"day").isAfter(J.hoveredFilterDateRange.value[0],"date")&&T.default(q).add(-1,"day").isBefore(J.hoveredFilterDateRange.value[1],"date"))return{style:{backgroundColor:"var(--mantine-color-red-light)",color:"var(--mantine-color-white)"}};return{style:{backgroundColor:"var(--mantine-color-red-filled)",color:"var(--mantine-color-white)"}}}},void 0,!1,void 0,this),P(w,{justifyContent:"flex-end",children:P(a,{size:C.value,onClick:()=>{J.filterValue.value.push(`${J.category.value} | ${r.value}`),J.filterDateRange.value=[null,null],J.filterSearchValue.value="",J.category.value=""},children:"Validate"},void 0,!1,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this),tQ=()=>P($Q,{gap:5,marginTop:10,children:P(w,{gap:8,children:[P(TQ,{},void 0,!1,void 0,this),P(jQ,{},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this);
export{gQ as d,tQ as e};
