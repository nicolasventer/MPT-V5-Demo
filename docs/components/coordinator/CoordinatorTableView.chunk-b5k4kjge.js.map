{
  "version": 3,
  "sources": ["..\\src\\components\\coordinator\\CoordinatorTableView.tsx"],
  "sourcesContent": [
    "import { Button, Popover, Table, Text } from \"@mantine/core\";\r\nimport { memo, useMemo, useRef, useState } from \"preact/compat\";\r\nimport type { VIEWS as _VIEWS } from \"../../Common/CommonModel\";\r\nimport { ExternalMissionStatusRender } from \"../../components/coordinator/ExternalMissionStatusRender\";\r\nimport { VerticalPassengersRender } from \"../../components/coordinator/PassengersRender\";\r\nimport { POBReportRender } from \"../../components/coordinator/POBReportRender\";\r\nimport { DateTimRender } from \"../../components/missionHolder/DateTimeRender\";\r\nimport { DriverPhoneRender } from \"../../components/missionHolder/DriverPhoneRender\";\r\nimport { VerticalRouteRender } from \"../../components/missionHolder/RouteRender\";\r\nimport { ServiceRender } from \"../../components/missionHolder/ServiceRender\";\r\nimport { tripleExampleMissions } from \"../../context/data\";\r\nimport { compactXsSm, smMd } from \"../../context/GlobalState\";\r\nimport { BasicCoordinatorMission } from \"../../context/types\";\r\nimport { useMount } from \"../../hooks/useMount\";\r\nimport { Horizontal, Vertical } from \"../../utils/ComponentToolbox\";\r\nimport { useExtraVirtualizer } from \"../../utils/virtualizerUtils\";\r\nimport { CoordinatorFilterZone } from \"./CoordinatorFilterZone\";\r\nimport { DetailsButton } from \"./MissionCard\";\r\n\r\nconst MissionRow = memo(({ mission, index }: { mission: BasicCoordinatorMission & { key: number }; index: number }) => {\r\n\tconst [isLoading, setIsLoading] = useState(true);\r\n\tuseMount(() => {\r\n\t\tconst timeout = setTimeout(() => setIsLoading(false), 200);\r\n\t\treturn () => clearTimeout(timeout);\r\n\t});\r\n\r\n\treturn isLoading ? (\r\n\t\t<Table.Td colSpan={9}>\r\n\t\t\t<div style={{ position: \"relative\", height: 80, display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}>\r\n\t\t\t\t<Horizontal gap={20}>\r\n\t\t\t\t\t<Text style={{ fontSize: \"20px\" }}>Start time</Text>\r\n\t\t\t\t\t<Text style={{ fontSize: \"40px\" }}>{mission.startTime}</Text>\r\n\t\t\t\t</Horizontal>\r\n\t\t\t</div>\r\n\t\t</Table.Td>\r\n\t) : (\r\n\t\t<>\r\n\t\t\t<Table.Td>\r\n\t\t\t\t<Vertical gap={3}>\r\n\t\t\t\t\t<DetailsButton index={index} />\r\n\t\t\t\t\t<POBReportRender mission={mission} position=\"bottom\" />\r\n\t\t\t\t</Vertical>\r\n\t\t\t</Table.Td>\r\n\t\t\t<Table.Td>\r\n\t\t\t\t<ExternalMissionStatusRender missionStatus={mission.missionStatus} />\r\n\t\t\t</Table.Td>\r\n\t\t\t<Table.Td>\r\n\t\t\t\t{/* TODO: render service if null */}\r\n\t\t\t\t<ServiceRender service={{ limo: mission.limo, short: mission.service ?? \"\" }} />\r\n\t\t\t</Table.Td>\r\n\t\t\t<Table.Td>\r\n\t\t\t\t<DateTimRender layout=\"vertical\" date={mission.date} startTime={mission.startTime} endTime={mission.endTime} />\r\n\t\t\t</Table.Td>\r\n\t\t\t<Table.Td>\r\n\t\t\t\t<VerticalRouteRender departure={mission.departure} steps={mission.steps_} arrival={mission.arrival} />\r\n\t\t\t</Table.Td>\r\n\t\t\t<Table.Td>\r\n\t\t\t\t<VerticalPassengersRender passengers={mission.passengers} />\r\n\t\t\t</Table.Td>\r\n\t\t\t<Table.Td>\r\n\t\t\t\t<Vertical gap={3}>\r\n\t\t\t\t\t<Text size={smMd.value}>{mission.driverName}</Text>\r\n\t\t\t\t\t<DriverPhoneRender mission={mission} />\r\n\t\t\t\t</Vertical>\r\n\t\t\t</Table.Td>\r\n\t\t\t<Table.Td style={{ textWrap: \"nowrap\" }}>\r\n\t\t\t\t{mission.vehicle}\r\n\t\t\t\t<br />\r\n\t\t\t\t{mission.licensePlate}\r\n\t\t\t</Table.Td>\r\n\t\t\t<Table.Td>{mission.client}</Table.Td>\r\n\t\t</>\r\n\t);\r\n});\r\n\r\n/**\r\n * Renders the coordinator table view, with a {@link CoordinatorFilterZone | filter zone} where you can select the {@link _VIEWS | view}, \\\r\n * a `Show more finished button`, and all the missions displayed in a table, with the following columns:\r\n * - Action with a `Details button` and a {@link POBReportRender | POB report} button.\r\n * - Status with the {@link ExternalMissionStatusRender | mission status}.\r\n * - Services with the {@link ServiceRender | service}.\r\n * - Date & Time with the {@link DateTimRender | date and time}.\r\n * - Route with the {@link VerticalRouteRender | route}.\r\n * - Passengers with the {@link VerticalPassengersRender | passengers}.\r\n * - Driver with the driver name and a {@link DriverPhoneRender | phone button}.\r\n * - License plate with the license plate number.\r\n * @returns The rendered coordinator table view component.\r\n */\r\nexport const CoordinatorTableView = () => {\r\n\tconst divRef = useRef<HTMLDivElement>(null);\r\n\tconst trRef = useRef<HTMLTableRowElement>(null);\r\n\tconst scrollRoot = useMemo(() => document.getElementById(\"scroll-root\"), []);\r\n\r\n\tconst { rowVirtualizer, expandedVirtualizeItems, startExpandedIndex } = useExtraVirtualizer({\r\n\t\tcount: tripleExampleMissions.value.length,\r\n\t\tgetScrollElement: () => scrollRoot,\r\n\t\testimateSize: () => 95,\r\n\t\toverscan: 2,\r\n\t\textraItemCount: 30,\r\n\t});\r\n\r\n\tconst firstVirtualRow = rowVirtualizer.getVirtualItems()[0];\r\n\r\n\t// retrieve the width of each th in the thead\r\n\tconst theadWidthArray: number[] = [];\r\n\tfor (const thRef of trRef.current?.children ?? []) theadWidthArray.push(thRef.clientWidth);\r\n\r\n\t// sync the horizontal scroll\r\n\tif (divRef.current && scrollRoot?.scrollLeft !== undefined) divRef.current.scrollLeft = scrollRoot.scrollLeft;\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{(firstVirtualRow?.start ?? 0) > 1200 && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tref={divRef}\r\n\t\t\t\t\tstyle={{ position: \"fixed\", top: 0, overflow: \"hidden\", zIndex: 231, paddingLeft: 16, width: \"calc(100% - 32px)\" }}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Table style={{ width: \"max-content\" }} withRowBorders={false}>\r\n\t\t\t\t\t\t<Table.Thead>\r\n\t\t\t\t\t\t\t<Table.Tr style={{ backgroundColor: \"var(--mantine-color-body)\" }}>\r\n\t\t\t\t\t\t\t\t<Table.Th style={{ width: theadWidthArray[0] }}>Action</Table.Th>\r\n\t\t\t\t\t\t\t\t<Table.Th style={{ width: theadWidthArray[1] }}>Status</Table.Th>\r\n\t\t\t\t\t\t\t\t<Popover withArrow position=\"top\" withinPortal={false}>\r\n\t\t\t\t\t\t\t\t\t<Popover.Target>\r\n\t\t\t\t\t\t\t\t\t\t<Table.Th style={{ width: theadWidthArray[2] }}>S..</Table.Th>\r\n\t\t\t\t\t\t\t\t\t</Popover.Target>\r\n\t\t\t\t\t\t\t\t\t<Popover.Dropdown>Services</Popover.Dropdown>\r\n\t\t\t\t\t\t\t\t</Popover>\r\n\t\t\t\t\t\t\t\t<Table.Th style={{ width: theadWidthArray[3] }}>Date & Time</Table.Th>\r\n\t\t\t\t\t\t\t\t<Table.Th style={{ width: theadWidthArray[4] }}>Route</Table.Th>\r\n\t\t\t\t\t\t\t\t<Table.Th style={{ width: theadWidthArray[5] }}>Passengers</Table.Th>\r\n\t\t\t\t\t\t\t\t<Table.Th style={{ width: theadWidthArray[6] }}>Driver</Table.Th>\r\n\t\t\t\t\t\t\t\t<Table.Th style={{ width: theadWidthArray[7] }}>Vehicle</Table.Th>\r\n\t\t\t\t\t\t\t\t<Table.Th style={{ width: 500 }}>Client</Table.Th>\r\n\t\t\t\t\t\t\t</Table.Tr>\r\n\t\t\t\t\t\t</Table.Thead>\r\n\t\t\t\t\t</Table>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t<div style={{ margin: \"0 16px\", position: \"sticky\", left: 16 }}>\r\n\t\t\t\t<CoordinatorFilterZone />\r\n\t\t\t</div>\r\n\t\t\t<div style={{ margin: \"0 16px\", height: rowVirtualizer.getTotalSize(), width: \"calc(100vw - 52px)\" }}>\r\n\t\t\t\t<Table stickyHeader stickyHeaderOffset={0} withRowBorders={false}>\r\n\t\t\t\t\t<Table.Thead style={{ zIndex: 230 }}>\r\n\t\t\t\t\t\t<Table.Tr ref={trRef}>\r\n\t\t\t\t\t\t\t<Table.Th>Action</Table.Th>\r\n\t\t\t\t\t\t\t<Table.Th>Status</Table.Th>\r\n\t\t\t\t\t\t\t<Popover withArrow position=\"top\" withinPortal={false}>\r\n\t\t\t\t\t\t\t\t<Popover.Target>\r\n\t\t\t\t\t\t\t\t\t<Table.Th>S..</Table.Th>\r\n\t\t\t\t\t\t\t\t</Popover.Target>\r\n\t\t\t\t\t\t\t\t<Popover.Dropdown>Services</Popover.Dropdown>\r\n\t\t\t\t\t\t\t</Popover>\r\n\t\t\t\t\t\t\t<Table.Th>Date & Time</Table.Th>\r\n\t\t\t\t\t\t\t<Table.Th>Route</Table.Th>\r\n\t\t\t\t\t\t\t<Table.Th>Passengers</Table.Th>\r\n\t\t\t\t\t\t\t<Table.Th>Driver</Table.Th>\r\n\t\t\t\t\t\t\t<Table.Th>Vehicle</Table.Th>\r\n\t\t\t\t\t\t\t<Table.Th>Client</Table.Th>\r\n\t\t\t\t\t\t</Table.Tr>\r\n\t\t\t\t\t</Table.Thead>\r\n\t\t\t\t\t<Table.Tbody>\r\n\t\t\t\t\t\t<Table.Tr>\r\n\t\t\t\t\t\t\t<Table.Td colSpan={9}>\r\n\t\t\t\t\t\t\t\t<div style={{ position: \"sticky\", left: 26, width: \"calc(100vw - 52px)\" }}>\r\n\t\t\t\t\t\t\t\t\t<Button size={compactXsSm.value} fullWidth>\r\n\t\t\t\t\t\t\t\t\t\tShow more finished\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Table.Td>\r\n\t\t\t\t\t\t</Table.Tr>\r\n\t\t\t\t\t\t{expandedVirtualizeItems.current.map((virtualRow) => (\r\n\t\t\t\t\t\t\t<Table.Tr\r\n\t\t\t\t\t\t\t\tkey={virtualRow.key}\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\theight: virtualRow.size,\r\n\t\t\t\t\t\t\t\t\ttransform: `translateY(${virtualRow.start - (virtualRow.index - startExpandedIndex) * virtualRow.size}px)`,\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<MissionRow mission={tripleExampleMissions.value[virtualRow.index]} index={virtualRow.index} />\r\n\t\t\t\t\t\t\t</Table.Tr>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</Table.Tbody>\r\n\t\t\t\t</Table>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n};\r\n"
  ],
  "mappings": "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",
  "debugId": "39F8D977FFC4C98A64756E2164756E21",
  "names": []
}